# 行人异常轨迹算法预研

**那些应用 那些论文 涉及到那些知识点  跑一下开源仓库代码**

**图论学习 graph to vec 学习 行人异常轨迹算法**

## 深度学习

&emsp;基于深度学习的方法：深度学习模型在行人异常轨迹检测应用：递归神经网络(RNN),长短时记忆网络LSTM或者卷积神经网络CNN,可以学习行人轨迹的时空模式，并监测异常。**深度学习比较注重提取视频中行人的外观和运动的高级特征，从而更有效地区分正常行为和异常行为**

### 监督学习
&emsp;监督学习：以采取监督学习的方法：首先需要收集该区域的正常行人轨迹数据，并对其进行标注，将正常和异常的行为进行区分，然后使用这些标注的数据来训练一个行人异常检测的模型，该模型可以学习到正常行人轨迹的模式，并能够检测到与之不一致的异常行为。在实时应用中，当有新的行人轨迹数据输入时，模型可以对其进行预测并且报告异常，使用户可以采取响应的测试.

**但是只能用于检测预定义的异常行为，由于预定义的异常行为范围有限，无法检测未定义的异常行为。**


### 无监督/半监督的学习方式

* 两阶段法
  CNN用于提取特征，再采用异常检测模块来检测异常行为，异常检测模块常用机器学习算法：SVM，高斯分类器，归一化算法

* 一阶段法
  直接采用end-to-end学习方式计算异常得分

**优缺点：基于空间特征检测异常方法能提取人群中行人外观的高级特征，并在异常检测中取得了良好的性能，但是忽略了视频序列中运动信息和时间结构**


### 数据集-行人异常行为

```
https://blog.csdn.net/mago2015/article/details/81588738

```


## 论文

### A Method for LSTM-Based Trajectory Modeling and Abnormal Trajectory Detection

**基于lstm的轨迹建模和异常轨迹检测方法**

* 思路
&emsp;首先自动获取正常的轨迹模型，然后将检测到的轨迹与轨迹模型进行比较，从而完成轨迹是否异常的判断。基于LSTM的建模方法和结合时空语义信息的异常检测方法可以解决问题

* 本文贡献
&emsp;
1. 轨迹建模，在SL-Modelling，直接得到适应不同长度的轨迹数据的正常轨迹组的序列类型轨迹模型，并手动减少提取特征的工作量
   
2. 异常轨迹检测，通过结合轨迹时空和语义信息计算轨迹模型与待检测轨迹之间的相似度，发现异常


* 异常检测的研究：
  1. 异常是什么
  2. 如何检测异常
  3. 异常如何生成


* 异常轨迹检测的分类
  1. 基于分类的检测方法
  2. 基于历史值相似度的检测方法
  3. 基于距离检测方法
  4. 基于网格生成的检测方法

**大多数异常轨迹检测方法都是集中在基于分类的检测方法和基于距离的检测方法。传统的异常轨迹方法是对轨迹数据进行聚类，如果轨迹不属于特定的类，那就说明是异常轨迹，还有一种方法是使用距离**

* 正常轨迹模型的建立SL-Modelling
  
  原理：LSTM编码器接受轨迹数据之后，LSTM模块根据等式计算并输出隐藏层的信息S，然后将S生成为LSTM解码器的输入，最后获得由解码器输出形成的建模结果

  轨迹数据集输入到训练好的SL-Modelling中，得到K个对应的轨迹模型

* 检测轨迹-使用时空信息和语义信息
  检测轨迹数据的时候，通常会引入轨迹相似度的概念，利用轨迹点或者轨迹序列之间的距离来描述轨迹之间的相似性

&emsp;运动轨迹的时空信息指的是轨迹点在时间和空间中的位置，比如当前卫星定位得到的经纬度，语义信息，比如轨迹方向，加速度或者轨迹通过的区域。可以使用轨迹的时空信息和语义信息同时研究异常轨迹检测

&emsp;Hausdorff距离用来衡量两个给定点集之间的不匹配成都，它可以测量形状相似度，是一种比较轨迹空间信息的更好测量方法。这里关注轨迹模型和待检测轨迹之间的整体形状的差异，并根据差异是否在阈值范围内来判断时空差异是否异常

&emsp;待检测轨迹的异常判断处理时将待检测轨迹与时空信息和语义信息的轨迹模型之间的相似度进行比较。将判断待检测轨迹是否异常，主要取决于相似性


&emsp;小结：LSTM模型，该模型将轨迹点作为输入序列，并使用LSTM单元来学习轨迹数据中的时序模式和依赖关系，模型还包括一个输出层，用于预测下一个轨迹点的位置。作者使用轨迹数据集，将其划分为训练集和验证集。然后定义一个损失函数，通过最小化预测轨迹点和真实轨迹点之间的距离来优化模型参数。他们使用随机梯度下降算法进行模型训练。异常轨迹检测：在轨迹建模之后，作者提出一种基于异常分数的方法来检测异常轨迹。他们计算每一个轨迹点的异常分数，通过与预先定义的阈值来进行比较来确定是否为异常点。









## 基于统计的方法

&emsp;使用统计学原理来建模正常行人轨迹，并检测与模型不一致的异常轨迹。例如，可以使用**高斯混合模型(GMM)或者马尔可夫模型(HMM)**来建模行人的移动模式。

## 基于机器学习的方法

&emsp;使用机器学习算法来学习正常行人轨迹的模式，并通过与模型的比较来检测异常。常用的机器学习算法包括支持向量机SVM,随机森林，神经网络等

